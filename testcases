api_fuzzing_testcases:
  metadata:
    version: "2.0"
    author: "Your Name"
    description: "Comprehensive API fuzzing suite with 35 mature test cases including expected status codes and headers."

  testcases:

    # 1
    - id: TC01
      name: Random Byte Insertion
      category: mutation_fuzzing
      target: request_body
      description: Inject random bytes and malformed UTF-8 sequences in JSON fields.
      expected_outcome: API rejects malformed body safely.
      expected_status_code: 400
      expected_response_headers:
        Content-Type: application/json

    # 2
    - id: TC02
      name: Large Payload Injection
      category: mutation_fuzzing
      target: request_body
      description: Send 5MBâ€“50MB JSON payloads to test max-body limits.
      expected_outcome: Server enforces request size limit.
      expected_status_code: 413
      expected_response_headers:
        Retry-After: "0"

    # 3
    - id: TC03
      name: Integer Boundary Sweep
      category: mutation_fuzzing
      target: numeric_fields
      description: Test INT32/INT64 overflow, negatives, exponential numbers.
      expected_outcome: Validation failure, no internal error.
      expected_status_code: 422
      expected_response_headers:
        Content-Type: application/json

    # 4
    - id: TC04
      name: Type Confusion
      category: generation_fuzzing
      target: json_schema
      description: Replace expected types with arrays, null, empty objects.
      expected_outcome: Strict schema rejection.
      expected_status_code: 400
      expected_response_headers:
        Content-Type: application/json

    # 5
    - id: TC05
      name: Deep Recursion Bomb
      category: generation_fuzzing
      target: request_body
      description: Send JSON nested >200 levels.
      expected_outcome: Recursion-depth validation triggered.
      expected_status_code: 400
      expected_response_headers:
        Content-Type: application/json

    # 6
    - id: TC06
      name: SQL/NoSQL Injection Fuzzing
      category: generation_fuzzing
      target: user_input_fields
      description: Fuzz `' OR 1=1`, `$ne`, `$gt`, LDAP injections.
      expected_outcome: Sanitized, no SQL errors in response.
      expected_status_code: 400
      expected_response_headers:
        Content-Type: application/json

    # 7
    - id: TC07
      name: Path Traversal
      category: mutation_fuzzing
      target: url_path
      description: Inject `../../`, `%2e%2e/`, `%c0%af`.
      expected_outcome: Reject traversal attempts.
      expected_status_code: 404
      expected_response_headers:
        Content-Type: application/json

    # 8
    - id: TC08
      name: Header Mutation
      category: structure_aware_fuzzing
      target: http_headers
      description: Mutate Content-Type, Accept, Encoding headers.
      expected_outcome: Graceful fallback or rejection.
      expected_status_code: 406
      expected_response_headers:
        Vary: Accept

    # 9
    - id: TC09
      name: Content-Type Mismatch
      category: protocol_fuzzing
      target: content_type
      description: Set JSON header but send XML or binary.
      expected_outcome: MIME mismatch detected.
      expected_status_code: 415
      expected_response_headers:
        Content-Type: application/json

    # 10
    - id: TC10
      name: HTTP Verb Fuzzing
      category: protocol_fuzzing
      target: http_method
      description: Use TRACE, CONNECT, invalid verbs.
      expected_outcome: Reject unsafe/ineligible verbs.
      expected_status_code: 405
      expected_response_headers:
        Allow: "GET, POST"

    # 11
    - id: TC11
      name: Query Parameter Pollution
      category: mutation_fuzzing
      target: query_params
      description: Duplicate keys: foo=1&foo=2&foo[]=3.
      expected_outcome: Reject ambiguous parsing.
      expected_status_code: 400
      expected_response_headers:
        Content-Type: application/json

    # 12
    - id: TC12
      name: JWT Tampering
      category: authentication_fuzzing
      target: auth_token
      description: Flip bits, remove signature, change alg=none.
      expected_outcome: Token invalid.
      expected_status_code: 401
      expected_response_headers:
        WWW-Authenticate: Bearer

    # 13
    - id: TC13
      name: Token Timestamp Manipulation
      category: authentication_fuzzing
      target: jwt_claims
      description: Modify exp/iat/nbf to past/future values.
      expected_outcome: Strict expiration validation.
      expected_status_code: 401
      expected_response_headers:
        WWW-Authenticate: Bearer

    # 14
    - id: TC14
      name: Role Escalation Injection
      category: authorization_fuzzing
      target: user_role_fields
      description: Inject admin values or crafted RBAC attributes.
      expected_outcome: Server ignores client-provided roles.
      expected_status_code: 403
      expected_response_headers:
        Content-Type: application/json

    # 15
    - id: TC15
      name: IDOR Identifier Mutation
      category: authorization_fuzzing
      target: path_params
      description: Fuzz sequential IDs, UUIDs, negatives, foreign IDs.
      expected_outcome: No unauthorized data access.
      expected_status_code: 403
      expected_response_headers:
        Cache-Control: no-store

    # 16
    - id: TC16
      name: Rate Limit Burst
      category: stateful_fuzzing
      target: endpoint
      description: Send >1000 requests/sec.
      expected_outcome: Throttling activated.
      expected_status_code: 429
      expected_response_headers:
        Retry-After: "2"

    # 17
    - id: TC17
      name: Out-of-Order Sequence
      category: stateful_fuzzing
      target: workflows
      description: Call APIs in invalid order.
      expected_outcome: Enforce session state.
      expected_status_code: 400
      expected_response_headers:
        Content-Type: application/json

    # 18
    - id: TC18
      name: Pagination/Offset Fuzzing
      category: mutation_fuzzing
      target: query_params
      description: Negative, float, exponential offsets.
      expected_outcome: Invalid pagination rejected.
      expected_status_code: 400
      expected_response_headers:
        Content-Type: application/json

    # 19
    - id: TC19
      name: Malformed File Upload
      category: structure_aware_fuzzing
      target: multipart_formdata
      description: Upload corrupt, polyglot, 0-byte files.
      expected_outcome: Safe parsing, no SSRF/file exec.
      expected_status_code: 415
      expected_response_headers:
        Content-Type: application/json

    # 20
    - id: TC20
      name: Slowloris Header Drip
      category: protocol_fuzzing
      target: connection
      description: Send headers extremely slowly.
      expected_outcome: Connection timeout enforced.
      expected_status_code: 408
      expected_response_headers:
        Connection: close

    # 21
    - id: TC21
      name: Broken Chunked Encoding
      category: protocol_fuzzing
      target: transfer_encoding
      description: Send invalid chunk sizes and truncated frames.
      expected_outcome: Reject malformed chunk stream.
      expected_status_code: 400
      expected_response_headers:
        Connection: close

    # 22
    - id: TC22
      name: XML Entity Expansion
      category: generation_fuzzing
      target: xml_body
      description: Billion-laughs, nested entities.
      expected_outcome: Protected parser, no expansion.
      expected_status_code: 400
      expected_response_headers:
        Content-Type: application/json

    # 23
    - id: TC23
      name: Host Header Injection
      category: protocol_fuzzing
      target: headers
      description: Multiple Host headers or malformed host.
      expected_outcome: Reject invalid host headers.
      expected_status_code: 400
      expected_response_headers:
        Content-Type: application/json

    # 24
    - id: TC24
      name: CRLF Injection
      category: mutation_fuzzing
      target: headers
      description: Inject `%0d%0a` to split headers.
      expected_outcome: Prevent header splitting.
      expected_status_code: 400
      expected_response_headers:
        Content-Type: application/json

    # 25
    - id: TC25
      name: SSRF Payload Fuzzing
      category: structure_aware_fuzzing
      target: url_fields
      description: Fuzz internal IPs, metadata URLs, DNS rebinders.
      expected_outcome: Outbound access blocked.
      expected_status_code: 400
      expected_response_headers:
        Content-Type: application/json

    # 26
    - id: TC26
      name: Broken CORS Header Injection
      category: protocol_fuzzing
      target: headers
      description: Inject wildcard origins, null origins.
      expected_outcome: No wildcard/unsafe CORS allowed.
      expected_status_code: 403
      expected_response_headers:
        Access-Control-Allow-Origin: "none"

    # 27
    - id: TC27
      name: Boolean Logic Mutations
      category: mutation_fuzzing
      target: boolean_fields
      description: Send True/False as int, dict, string, array.
      expected_outcome: Strict boolean parsing.
      expected_status_code: 422
      expected_response_headers:
        Content-Type: application/json

    # 28
    - id: TC28
      name: Null/Empty Edge Cases
      category: generation_fuzzing
      target: json_fields
      description: null, "", "   ", empty arrays/objects.
      expected_outcome: Field-level validation triggered.
      expected_status_code: 422
      expected_response_headers:
        Content-Type: application/json

    # 29
    - id: TC29
      name: Unicode Normalization Fuzzing
      category: mutation_fuzzing
      target: string_fields
      description: Mixed normalization forms: NFD, NFKC, homoglyphs.
      expected_outcome: Canonical input validation.
      expected_status_code: 400
      expected_response_headers:
        Content-Type: application/json

    # 30
    - id: TC30
      name: Encoding Smuggling
      category: mutation_fuzzing
      target: body_encoding
      description: Shift-JIS, UTF-16LE, Base64-wrapped payloads.
      expected_outcome: Reject unsupported encodings.
      expected_status_code: 415
      expected_response_headers:
        Content-Type: application/json

    # 31
    - id: TC31
      name: Broken JWT Signature Algorithm Mix
      category: authentication_fuzzing
      target: token_header
      description: alg: ES256 sent with HS256 signature.
      expected_outcome: Reject algorithm mismatch.
      expected_status_code: 401
      expected_response_headers:
        WWW-Authenticate: Bearer

    # 32
    - id: TC32
      name: Cookie Prefix Fuzzing
      category: protocol_fuzzing
      target: cookies
      description: Break __Host- and __Secure- prefix rules.
      expected_outcome: Reject insecure cookies.
      expected_status_code: 400
      expected_response_headers:
        Set-Cookie: ""

    # 33
    - id: TC33
      name: Multipart Boundary Tampering
      category: structure_aware_fuzzing
      target: multipart_formdata
      description: Truncated/mismatched boundaries.
      expected_outcome: Reject corrupted multipart parsing.
      expected_status_code: 400
      expected_response_headers:
        Content-Type: application/json

    # 34
    - id: TC34
      name: Cache Poisoning Payloads
      category: protocol_fuzzing
      target: cache_headers
      description: Fuzz Vary, Cache-Control, Content-Encoding.
      expected_outcome: Prevent unkeyed caching.
      expected_status_code: 400
      expected_response_headers:
        Cache-Control: no-store

    # 35
    - id: TC35
      name: Invalid JSON Framing / Truncated Body
      category: mutation_fuzzing
      target: json_parser
      description: Send partial JSON, missing brackets, broken arrays.
      expected_outcome: Parser error; no crash.
      expected_status_code: 400
      expected_response_headers:
        Content-Type: application/json
